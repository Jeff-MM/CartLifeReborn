// room script file

bool georgefought;

function on_event(EventType event, int data) {
  if (event==eEventEnterRoomBeforeFadein) 
{
       musique=(music_slider.Value);
     if (musique<=17) SetMusicVolume(-3);
else if ((musique>=18)&&(musique<=34))SetMusicVolume(-2);
else if ((musique>=35)&&(musique<=50))SetMusicVolume(-1);
else if ((musique>=51)&&(musique<=68))SetMusicVolume(0);
else if ((musique>=69)&&(musique<=85))SetMusicVolume(1);
else if ((musique>=86)&&(musique<=95))SetMusicVolume(2);
else if (musique>=96)SetMusicVolume(3);
SetMusicMasterVolume((music_slider.Value));
bgbldgs.SetPosition(-10, 254);
cattro.Transparency=99;
glembox.Transparency=99;
if (GetGlobalInt(101)<6){glembox.Transparency=99;}
if (GetGlobalInt(101)==6){glembox.Transparency=0;}
if (GetGlobalInt(101)==7){glembox.Graphic=2633; glembox.Transparency=0;}
if (GetGlobalInt(101)==9){glembox.Transparency=0;}
if (GetGlobalInt(101)>=10){glembox.Transparency=0;}

if (GetGlobalInt(10)==1){//Start Inside the Room
         SetGlobalInt(106, 0);
         RestoreWalkableArea(2);
         glembox.SetView(109); glembox.Animate(0, 4, eRepeat,eNoBlock, eForwards);
         SetWalkBehindBase (1,195);
         aOverlay.Baseline = 500;
         aOverlay.Transparency=0;
         room_rail.Transparency=99;
         aDoor.Transparency=99;
       FadeObjectOut_NoBlock(aOverlay, 99, -5, 10);}

player.Transparency=0;
if (GetGlobalInt(10)!=1){RemoveWalkableArea(2); SetWalkBehindBase (1, 0); aOverlay.Baseline = 10; 
aDoor.Baseline=55; //Used to be "2"
SetGlobalInt(106, 1);}
//player.ManualScaling = true;
//player.Scaling = 90;

if ((ampm==0)&&((hour<8)&&(hour>=1))){//Early Morning
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//dark
if ((ampm==0)&&(hour>=8)&&(hour!=12)){//Morning
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour==12)){//NOON
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour<=8)&&(hour!=12)){//day
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour>=9)&&(hour!=12)){//Night
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//Dark
if ((ampm==0)&&(hour==12)){//Midnight
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//Dark

NatMusic(9); 

if ((dayspassed==7)&&(rentpaid==0)){George.ChangeRoom(7, 455, 140); George.UnlockView(); George.Walk(337, 140, eNoBlock, eAnywhere);}
if ((dayspassed==14)&&(rentpaid==1)){George.ChangeRoom(7, 455, 140); George.UnlockView(); George.Walk(337, 140, eNoBlock, eAnywhere);}
if ((dayspassed==21)&&(rentpaid==2)){George.ChangeRoom(7, 455, 140); George.UnlockView(); George.Walk(337, 140, eNoBlock, eAnywhere);}

if (GetGlobalInt(101)>=13){
if ((milhour>=9)&&(milhour<=18)){//Suchin Broomington / Matts
if (George.Room!=7){//Prevents plot hole with George letting the cat out, and Suzie talking about it.
SetTimer(1, 120); Suchin.ChangeRoom(7, 194, 194); Suchin.LockView(226); Suchin.Baseline=0;
Suchin.Walk(20, 194, eNoBlock, eAnywhere);
if (dayspassed<12){Matts.ChangeRoom(7, 420, 75); Matts.LockView(239); Matts.Baseline=0;}//Don't forget Matts.
}}}

georgefought=false;

bgbldgs.Baseline=1;
bldg.Baseline=2; SetTimer(1, 120);//For the BroomPush(); function.
}}

int glembattle=0;//Incremental state leading up to Cat Escape
int glemcomplained=0;//0:Ready to Whine  1:Whined, for now. Goes back to 0 on leave, so he can complain again.
int broomtalk=0;//Incremental state.
int broomtalked=0;//0:Ready to Talk 1:Talked, for now.
int kickedouttalk=0;//Only activated when andrus gets kicked out.

function BroomPush(){
if (gDialog.Visible==true){}
  else {
   //Suchin
   if (Suchin.Room==7){
   int Broomyeah=Random(3);
   int Broomydest=((Random(500))+208);
   if (Broomyeah==0){Suchin.StopMoving(); Suchin.Animate(0, 3, eRepeat, eNoBlock, eForwards);}
   if (Broomyeah!=0){Suchin.Walk(Broomydest, 194, eNoBlock, eAnywhere);}}
   //Matts
   if (Matts.Room==7){   int roundandround=Random(20);
   if ((Matts.Loop==7)||(Matts.Loop==8)){
   if (roundandround<=10){Matts.Animate(8, 3, eOnce, eNoBlock);}//Lookaround
   if ((roundandround>10)&&(roundandround<19)){Matts.Animate(7, 3, eOnce, eNoBlock);}}//Puff
   if (Matts.Animating==false){
   if (Matts.Loop==6){Matts.Animate(7, 3, eOnce, eNoBlock);}
   if ((Matts.Loop!=6)&&(Matts.Loop!=7)&&(Matts.Loop!=8)){Matts.Animate(6, 3, eOnce, eNoBlock);}}
   if (roundandround>=19){
   if (Matts.x<460){//Only if he's not there already
   Matts.Walk(460, (Matts.y), eNoBlock, eAnywhere);}}//Walkoff
   }
     
SetTimer(1, 120);}}


function talk_Glembovski()
{
if (DBG0.Graphic ==2184){

  if (GetGlobalInt(101)<5){//Outside
  DBG2.NormalGraphic=1408; APkittylisten(); glemtalks(); dText.Text=("Mrow. "); blab2();//Cat Talk
  APkittytalk(); glemlistens(); dText.Text=("Yes. Hello, Mr. Glembovski. "); blab2();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("I.. Yes. Please to wait outside here while I get a room for us. "); blab4();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  PCListen(); glemlistens(); dText.Text=(" "); dName.Text=(" "); StopPop(); 
  }


  if (GetGlobalInt(101)==5){//FIRST CONV.
  DBG2.NormalGraphic=1408;
  APkittylisten(); glemtalks(); dText.Text=("Mrow. "); blab2();//George Talk
  APkittytalk(); glemlistens(); dText.Text=("Yes. Hello, Mr. Glembovski. "); blab2();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("I.. Yes. We've found a new home. "); blab3();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("How long? "); blab1();
  APkittytalk(); dText.Text=("I'm not sure. A few weeks, maybe."); blab3();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("You must be quiet. You are secret, here."); blab3();//PC Talk
  APkittytalk(); dText.Text=("Pets cost extra. "); blab1();//PC Talk
  APkittylisten(); glemtalks(); dText.Text=("Mrroaaw. "); blab1();//George Talk
  APkittytalk(); glemlistens(); dText.Text=("Yes, I understand. "); blab1();//PC Talk
  APkittytalk(); dText.Text=("I will get a new littershed for you, and food. "); blab3();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("You stay here, in the room now."); blab2();//George Talk
  APkittytalk(); dText.Text=("See you soon, Mr. Glembovski."); blab2();//George Talk
  glemlistens(); dText.Text=(" "); dName.Text=(" "); StopPop(); SetGlobalInt(101, 6); }
  
  else if ((GetGlobalInt(101)>=6)&&(GetGlobalInt(101)!=7)){
  int shp=Random(2); DBG2.NormalGraphic=1408;
  if (shp==0) {
  DBG2.NormalGraphic=1408; APkittylisten();
  APkittylisten(); glemtalks(); dText.Text=("Meeow."); blab2();//George Talk
  APkittytalk(); glemlistens(); dText.Text=("Hello, sir."); blab1();//PC Talk
  APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab1();//Cat Mute
  APkittytalk(); dText.Text=("Okay."); blab1();//PC Talk
  glemlistens(); APkittylisten(); dText.Text=(" "); dName.Text=(" "); StopPop();}

else if (shp==1){
int ask=Random(5);
APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab2();//Cat Mute
APkittytalk(); glemlistens(); 
if (ask==0){dText.Text=("Are you happy, Mr. Glembovski?"); blab2();}
if (ask==1){dText.Text=("What do you think about, Mr. Glembovski?"); blab2();}
if (ask==2){dText.Text=("Do you like it here, Mr. Glembovski?"); blab2();}
if (ask==3){dText.Text=("Are you warm enough?"); blab1();}
if (ask==4){dText.Text=("Do you miss other housecats, Mr. Glembovski?"); blab3();}
if (ask==5){dText.Text=("How are you today, Mr. Glembovski?"); blab2();}
APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab2();//Cat Mute
glemlistens(); APkittylisten(); dText.Text=(" "); dName.Text=(" "); StopPop();}

else if (shp==2){
int ask=Random(5);
APkittylisten(); dName.Text=("Glembovski: "); dText.Text=("..."); blab2();//Cat Mute
APkittytalk(); glemlistens(); 
if (ask==0){dText.Text=("Are you happy, Mr. Glembovski?"); blab2();}
if (ask==1){dText.Text=("What do you think about, Mr. Glembovski?"); blab2();}
if (ask==2){dText.Text=("Do you like it here, Mr. Glembovski?"); blab2();}
if (ask==3){dText.Text=("Are you warm enough?"); blab1();}
if (ask==4){dText.Text=("Do you miss other housecats, Mr. Glembovski?"); blab3();}
if (ask==5){dText.Text=("How are you today, Mr. Glembovski?"); blab2();}
APkittylisten(); glemtalks(); dText.Text=("Mrow."); blab1();//George Talk
glemlistens(); APkittylisten(); dText.Text=(" "); dName.Text=(" "); StopPop();}}

  else if (GetGlobalInt(101)==7){
  DBG2.NormalGraphic=373; dName.Text=("Andrus: "); 
  PCTalk(); DBG1.Animate(16, 6, 3, eRepeat); dText.Text=("Mr. Glembovski?"); dpb.Visible=true; dpb.Animate(110, 0, 1, eOnce); blab1();
  PCListen(); DBG1.Animate(16, 7, 3, eRepeat); dText.Text=("....."); dpb.Visible=true; dpb.Animate(110, 0, 1, eOnce);blab2();
  PCTalk(); DBG1.Animate(16, 6, 3, eRepeat); dText.Text=("Mr. Glembovski?!!"); dpb.Visible=true; dpb.Animate(110, 0, 1, eOnce); blab1();
  PCListen(); DBG1.Animate(16, 7, 3, eRepeat); dText.Text=("....."); dpb.Visible=true; dpb.Animate(110, 0, 1, eOnce);blab2();
  PCTalk(); DBG1.Animate(16, 6, 3, eRepeat); dText.Text=("How did you escape?!"); dpb.Visible=true; dpb.Animate(110, 0, 1, eOnce); blab1();
  StopPop(); SetGlobalInt(101, 8); SetTimer(14, 1200); caffeine.Width=10;}
  dName.Text=(" "); dText.Text=(" "); SetTimer(3, 0);}
else 
{}}



function region1_WalksOnto()
{
     if (GetGlobalInt(106) == 0) {aDoor.Transparency=50;}
else if (GetGlobalInt(106) == 1) {}
}

function region1_WalksOff()
{
     if (GetGlobalInt(106) == 0) {aDoor.Transparency=99;}
else if (GetGlobalInt(106) == 1) {}
}


function region1_Standing()
{
       if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)) //UP ARROW
       { 
if ((kickedout==1)&&(George.x==265)&&(George.Room==7)){dFinalGeorge.Start();}

else{       
       
       if (GetGlobalInt(106) == 0) //INSIDE GOING OUT
          {player.DoorHandle();
           int ran=Random(2); {if (ran==0) PlaySound(33); else if (ran==1) PlaySound(35); else if (ran==2) PlaySound(37);}
           aDoor.SetView(15);
           aDoor.Animate(0, 3, eOnce, eBlock, eForwards);
           aDoor.Transparency=0;
           FadeObjectIn_NoBlock(aOverlay, 0, -15);
           FadeObjectIn_NoBlock(room_rail, 0, -15);
           RemoveWalkableArea(2); 
           SetWalkBehindBase (1, 0);
           aOverlay.Baseline = 5;
           aDoor.Baseline=6;
           player.DoorHandle2();
           int ranb=Random(2); {if (ranb==0) PlaySound(34); else if (ranb==1) PlaySound(36); else if (ranb==2) PlaySound(38);}
           aDoor.SetView(15);
           aDoor.Animate(1, 3, eOnce, eBlock, eForwards);
           aDoor.Transparency=0;
           room_rail.Transparency=0;
           SetGlobalInt(106,1); 
          }       
       else if (GetGlobalInt(106) == 1){//OUTSIDE GOING IN
           if (cSlot2.InventoryQuantity[A3Key.ID]==0){
           Wait(5); player.DoorHandle(); Wait(20); PlaySound(60); TopUp("Locked", "This door won't open. It's locked."); player.DoorHandle2();}
           
           else if ((kickedout==1)&&(cSlot2.InventoryQuantity[A3Key.ID]!=0)){
           Wait(5); player.DoorHandle(); Wait(20); PlaySound(60); TopUp("Locked", "It's locked, and the key won't fit."); player.DoorHandle2(); 
           cSlot2.LoseInventory(A3Key); cSlot2.AddInventory(A3Key2);}

           else if (rentpaid!=true){
           player.DoorHandle();
           int ran=Random(2); {if (ran==0) PlaySound(33); else if (ran==1) PlaySound(35); else if (ran==2) PlaySound(37);}
           aDoor.SetView(15);
           aDoor.Animate(0, 3, eOnce, eBlock, eForwards);
           RestoreWalkableArea(2);
           SetWalkBehindBase (1,141);
           aDoor.Baseline=400;
           aOverlay.Baseline = 500;
           player.Transparency=0;
           aOverlay.Transparency=0;
           player.DoorHandle2();
           int ranb=Random(2); {if (ranb==0) PlaySound(34); else if (ranb==1) PlaySound(36); else if (ranb==2) PlaySound(38);}
           aDoor.SetView(15);
           aDoor.Animate(1, 3, eOnce, eBlock, eForwards);
           FadeObjectOut_NoBlock(aOverlay, 99, -5, 10);
           Wait(10);
           aDoor.Transparency=50;
           room_rail.Transparency=99;
           SetGlobalInt(106,0); 
           if (GetGlobalInt(101)==7){
           if (gDialog.Visible==false){TalkPop(); SetTimer(3, 43);}}
           if ((GetGlobalInt(101)>=10)&&(kibbles.Width<=10)&&(glemcomplained==0)){//The Cat's fucking hungry, goddamnit!
           glembattle+=1; glemcomplained=1;
           if(glembattle==1){
           glemlistens(); PCListen();
           TalkPop(); Wait(40);
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("What is it, Mr. Glembovski?"); blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("Oh - you are must being very hungry?");blab1();
           glemlistens(); PCTalk(); dText.Text=("I will get food for you - I promise.");blab1();
           PCListen(); glemlistens(); StopPop();}
           if(glembattle==2){
           glemlistens(); PCListen();
           TalkPop(); Wait(40);
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("What is it, Mr. Glembovski?");blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("Oh - you are must being very hungry?");blab1();
           glemlistens(); PCTalk(); dText.Text=("I will get food for you - I promise.");blab1();
           PCListen(); glemlistens(); StopPop();}
           if(glembattle==3){
           glemlistens(); PCListen();
           TalkPop(); Wait(40);
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("What is it, Mr. Glembovski?");blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("Oh - you are must being very hungry?");blab1();
           glemlistens(); PCTalk(); dText.Text=("I will get food for you - I promise.");blab1();
           PCListen(); glemlistens(); StopPop();}
           if(glembattle==4){
           glemlistens(); PCListen();
           TalkPop(); Wait(40);
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("What is it, Mr. Glembovski?");blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("Oh - you are must being very hungry?");blab1();
           glemlistens(); PCTalk(); dText.Text=("I will get food for you - I promise.");blab1();
           PCListen(); glemlistens(); StopPop();}
           if(glembattle==5){
             //Glembovski Runs Away!
           glemlistens(); PCListen();
           TalkPop(); Wait(40);
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Mrrraaoooww!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("What is it, Mr. Glembovski?");blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("I can't take it anymore!"); blab2();
           glemlistens(); PCTalk(); dText.Text=("You can talk?!");blab1();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("Why don't you ever feed me?!"); blab2();
           glemtalks(); PCListen(); DBG2.Animate(67, 2, 3, eRepeat);  dText.Text=("I'm leaving!"); blab2();
           PCListen(); glemlistens(); StopPop();
           QuitGame(0);}
           }//End Cat Hunger Debate
           }//End Normal Going Inside
           else if (rentpaid==true){//End this thing.
           player.DoorHandle();
           int ran=Random(2); {if (ran==0) PlaySound(33); else if (ran==1) PlaySound(35); else if (ran==2) PlaySound(37);}
           aDoor.SetView(15);
           aDoor.Animate(0, 3, eOnce, eBlock, eForwards);
           RestoreWalkableArea(2);
           SetWalkBehindBase (1,141);
           aDoor.Baseline=400;
           aOverlay.Baseline = 500;
           player.Transparency=0;
           aOverlay.Transparency=0;
           player.DoorHandle2();
           int ranb=Random(2); {if (ranb==0) PlaySound(34); else if (ranb==1) PlaySound(36); else if (ranb==2) PlaySound(38);}
           aDoor.SetView(15);
           aDoor.Animate(1, 3, eOnce, eBlock, eForwards);
           FadeObjectOut_NoBlock(aOverlay, 99, -5, 10);
           Wait(10);
           aDoor.Transparency=50;
           room_rail.Transparency=99;
           SetGlobalInt(106,0); 
           //Cutscene first.
           FadeOut(10);//CHECKOUT
           SaveGameSlot(1, "Andrus Autosave"); NewScores(0, 4);//Good Ending
           if (playstate_melanie==1){NewScores(3, 1);}//BONUS
           Wait(5);
           aMusic12.Play();//Condiments Unspread
           gPick.Visible=true; pick.NormalGraphic=5781; gameover=true;
           vitality.Width=120; nutrition.Width=120; kibbles.Width=120; caffeine.Width=120;//Just in case.
           gPick.Centre(); pick.X=0; pick.Y=0; close_pick.Visible=false;
           Wait(5);
           FadeIn(10);
           Wait(5);
           pick.Animate(280, 0, 3, eOnce); //First
           while (pick.NormalGraphic!=8851){Wait(1);}
           
           if (player.InventoryQuantity[Contract_Bad.ID]==0){//Paid!
            pick.Animate(280, 1, 3, eOnce);//Sit down
            while (pick.NormalGraphic!=8862){Wait(1);}
            Wait(50);}//Extra Wait
           
          else if (player.InventoryQuantity[Contract_Bad.ID]!=0){//Didn't pay it.
            if (Money>=35.00){//Enough to pay it, at least
            pick.Animate(280, 2, 3, eOnce);//Hmm...
            while (pick.NormalGraphic!=8905){Wait(1);}
            Wait(30);//Extra Wait
            }
          else if (Money<35.00){//Can't even pay it.
            pick.Animate(280, 3, 3, eOnce);//Hmm...
            while (pick.NormalGraphic!=8905){Wait(1);}
            Wait(30);//Extra Wait
          }
  }
  FadeOut(1);
  Wait(5); gPick.Visible=false;
  SetGlobalInt(101, 77);//Same as "Game Over" when going to Franklin for Credits Sequence
  SetNextScreenTransition(eTransitionFade);
  hour=8; ampm=1; milhour=20;
  player.ChangeRoom(5, 333, 160);
  }//End Ending
}}
          
}
}

function region2_Standing()
{
       if ((IsKeyPressed(380)==1)||(IsKeyPressed(83)==1)){//Down Arrow
       if (GetGlobalInt(11)==0){
       player.UnlockView();
       player.LockView(8); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(474, 193, eBlock, eAnywhere);
       player.UnlockView();}
     
     else if (GetGlobalInt(11)==1){
       player.UnlockView();
       player.LockView(31); 
       player.Animate(2, 2, eRepeat, eNoBlock, eForwards);
       player.Walk(474, 193, eBlock, eAnywhere);
       player.UnlockView();
       }}
}

function region3_Standing()
{
       if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)) //Up Arrow
       {if (GetGlobalInt(11)==0){
       player.UnlockView();
       player.LockView(7); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(417, 139, eBlock, eAnywhere);
     player.UnlockView();}
     else if (GetGlobalInt(11)==1){
       player.UnlockView();
       player.LockView(31); 
       player.Animate(1, 2, eRepeat, eNoBlock, eForwards);
       player.Walk(417, 139, eBlock, eAnywhere);
       player.Animate(1, 2, eRepeat, eNoBlock, eForwards);
       player.UnlockView();
       }}
}
bool glemedged;
function room_LeaveLeft()
{
if ((GetGlobalInt(101)==8)||(GetGlobalInt(101)==9)){//Cat's out - can't leave //TopUp("Wait!", "You have to find Mr. Glembovski!!"); 
  PlaySound(60); cAndrus.StopMoving(); cAndrus.UnlockView(); Wait(20); 
  gPick.BackgroundGraphic=8401;
  if (glemedged!=true){glemedged=true;
  pick.NormalGraphic=8402; gPick.Visible=true; pick.Animate(108, 7, 3, eOnce);}
  else {pick.NormalGraphic=8416; gPick.Visible=true; pick.Animate(108, 8, 3, eOnce);}
  cAndrus.x=player.x+30; cAndrus.y=192; Wait(200);
  gPick.Visible=false; gPick.BackgroundGraphic=2371;}

else if (GetGlobalInt(101)<=4){PlaySound(60); cAndrus.StopMoving(); cAndrus.UnlockView(); Wait(20); TopUp("Wait!", "You need a place to sleep!"); cAndrus.x=player.x+30; cAndrus.y=192; Wait(10);}
else {
FadeOut(5);
player.ManualScaling=false;
Wait(5); SetGlobalInt(10, 0);
SetGlobalInt(98,7); if (George.Room==7){George.ChangeRoom(24, 100, 100);}
player.ChangeRoom(10, 100, 100);}
}

function room_LeaveRight()
{
if ((GetGlobalInt(101)==8)||(GetGlobalInt(101)==9)){//Cat's out - can't leave //TopUp("Wait!", "You have to find Mr. Glembovski!!"); 
  PlaySound(60); cAndrus.StopMoving(); cAndrus.UnlockView(); Wait(20); 
  gPick.BackgroundGraphic=8401;
  if (glemedged!=true){glemedged=true;
  pick.NormalGraphic=8402; gPick.Visible=true; pick.Animate(108, 7, 3, eOnce);}
  else {pick.NormalGraphic=8416; gPick.Visible=true; pick.Animate(108, 8, 3, eOnce);}
  cAndrus.x=(player.x-30); cAndrus.y=192; Wait(200);
  gPick.Visible=false; gPick.BackgroundGraphic=2371;}

else if (GetGlobalInt(101)<=4){PlaySound(60); cAndrus.StopMoving(); cAndrus.UnlockView(); Wait(20); TopUp("Wait!", "You need a place to sleep!"); cAndrus.x=player.x-30; cAndrus.y=192; Wait(10);}
else {
FadeOut(5);
player.ManualScaling=false;
SetGlobalInt(98,7);
Wait(5); SetGlobalInt(10, 0);if (George.Room==7){George.ChangeRoom(24, 100, 100);}
player.ChangeRoom(10, 100, 100);
}}

function region5_Standing(){
if((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))
  {
if ( ((ampm==0)&&((hour<=7)||(hour==12)))||((ampm==1)&&(hour>=10)&&(hour!=12))&&(cSlot2.InventoryQuantity[A3Key.ID]!=0)){
Wait(5); player.DoorHandle(); Wait(20); PlaySound(60); TopUp("Locked", "This door won't open. It's locked."); player.DoorHandle2();}
else{
  if (player.View==31){PlaySound(60); TopUp("Oh, no!", "Don't let the desk clerk see the cat!");}
  else{
player.DoorHandle();
int ran=Random(1);
    {    if (ran==0) PlaySoundEx(33, 3);
    else if (ran==1) PlaySoundEx(35, 3);
    }
  hotel_door.SetView(30, 0, 0);
  hotel_door.Animate(0, 2, eOnce, eBlock);  
  player.DoorHandle2();
  int ran2=Random(1);
    {    if (ran2==0) PlaySoundEx(34, 3);
    else if (ran2==1) PlaySoundEx(36, 3);
    }  
FadeCharacterOut_NoBlock(player, 99, -15, 0);
  hotel_door.Animate(1, 1, eOnce, eBlock);  
  player.ChangeRoom(28, 119, 156);
}}
}}

function room_RepExec(){

if ((stereopower==0)&&(GetCurrentMusic()==-0)){NatMusic(9);}

if (IsTimerExpired(1)==1){BroomPush();}

if (Matts.x==460){b5_door.SetView(240); b5_door.Animate(0, 2, eOnce, eNoBlock); Matts.x+=1;}
if (b5_door.Graphic==6873){Matts.Baseline=1;}

if (IsTimerExpired(3)==1){
  if (GetGlobalInt(101)==7){talk_Glembovski();}
else{
  player.LockView(31);
  player.Animate(6, 3, eOnce, eBlock);
  player.LockView(28);
  player.Animate(6, 3, eRepeat, eNoBlock);
  talk_Glembovski();}}

if (IsTimerExpired(14)==1){
  if (GetGlobalInt(101)==8){//Oh! Me So Solly!
  hotel_door.SetView(30, 0, 0); hotel_door.Animate(0, 2, eOnce, eNoBlock);  
  Suchin.ChangeRoom(7, 214, 193); Suchin.Transparency=99;
  int ran2=Random(1);
    {    if (ran2==0) PlaySoundEx(34, 3);
    else if (ran2==1) PlaySoundEx(36, 3);
    }  
FadeCharacterIn_NoBlock(Suchin, 0, -15);
  hotel_door.Animate(1, 1, eOnce, eNoBlock); 
  Suchin.Walk(326, 192, eNoBlock, eAnywhere);}
else{}}

if ((kickedout==1)&&(George.x==212)&&(George.y==192)){//George Goes In.
hotel_door.SetView(30, 0, 0); hotel_door.Animate(0, 2, eOnce, eNoBlock); 
George.ChangeRoom(28, 205, 149); Wait(5); hotel_door.Animate(1, 2, eOnce, eNoBlock);}

if ((ampm==0)&&((hour<8)&&(hour>=1))){//Early Morning
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//dark
if ((ampm==0)&&(hour>=8)&&(hour!=12)){//Morning
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour==12)){//NOON
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour<=8)&&(hour!=12)){//day
SetBackgroundFrame(0); bldg.Graphic=6623; Sign.Graphic=6636; bgbldgs.Graphic=5252; aOverlay.Graphic=6633;}//Light
if ((ampm==1)&&(hour>=9)&&(hour!=12)){//Night
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//Dark
if ((ampm==0)&&(hour==12)){//Midnight
SetBackgroundFrame(1); bldg.Graphic=6624; Sign.Graphic=6637; bgbldgs.Graphic=5253; aOverlay.Graphic=6634;}//Dark

if (player.y>201){player.y=198;}

//========// Rent Smackdown //==========//
if ((dayspassed==7)&&(rentpaid==0)){
if ( ((George.x - player.x) <= 40) && ((George.x - player.x) >= 10)&& ((George.y - player.y) > 0)&& (George.Room==cAndrus.Room)){//In Range!
player.StopMoving();
TalkPop(); Wait(40); salebuyer=("George"); customerlisten();
PCListen(); customertalk(); dText.Text=("Where your rent?"); blab1();
PCTalk(); customerlisten(); dText.Text=("Yes. I..."); blab1();
PCListen(); customertalk(); dText.Text=("You pay now, Okay?"); blab1();
PCListen(); customerlisten(); dName.Text=(" "); dText.Text=(" ");
if (Money<119.00){dGeorgerent.SetOptionState(2, eOptionOff);}
dGeorgerent.Start();}}//Week One

if ((dayspassed==14)&&(rentpaid==1)){
if (( ((George.x - player.x) <= 40) && (George.x - player.x) >= 10)&& (George.Room==cAndrus.Room)){//In Range!
player.StopMoving();
TalkPop(); Wait(40); salebuyer=("George"); customerlisten();
PCListen(); customertalk(); dText.Text=("Where your rent?"); blab1();
PCTalk(); customerlisten(); dText.Text=("Yes. I..."); blab1();
PCListen(); customertalk(); dText.Text=("You pay now, Okay?"); blab1();
PCListen(); customerlisten(); dName.Text=(" "); dText.Text=(" ");
if (Money<119.00){dGeorgerent.SetOptionState(2, eOptionOff);}
dGeorgerent.Start();}}//Week One

if ((dayspassed==21)&&(rentpaid==2)){
if (( ((George.x - player.x) <= 40) && (George.x - player.x) >= 10)&& (George.Room==cAndrus.Room)){//In Range!
player.StopMoving();
TalkPop(); Wait(40); salebuyer=("George"); customerlisten();
PCListen(); customertalk(); dText.Text=("Where your rent?"); blab1();
PCTalk(); customerlisten(); dText.Text=("Yes. I..."); blab1();
PCListen(); customertalk(); dText.Text=("You pay now, Okay?"); blab1();
PCListen(); customerlisten(); dName.Text=(" "); dText.Text=(" ");
if (Money<119.00){dGeorgerent.SetOptionState(2, eOptionOff);}
dGeorgerent.Start();}}//Week One

//Uptalk
if (((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(GetGlobalInt(101)>9)){//UP Uptalk!
if (gDialog.Visible==true){}
if (gPick.Visible==true){}
if ( ((Suchin.x - player.x) <= 50) && ((Suchin.x - player.x) >= 10)&&((Suchin.y - player.y)<= 5)&&(Suchin.Room==cAndrus.Room)){//SUCHIN!
   Suchin.StopMoving();
   TalkPop(); Wait(40); salebuyer=("Suchin"); customerlisten();
if (kickedout==1){kickedouttalk+=1;
  if (kickedouttalk==1){
   PCListen(); SuchinTalkSad(); dText.Text=("You..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I so sorry George kick you out."); blab2();
   PCListen(); SuchinListenSad(); dName.Text=("Andrus: "); dText.Text=("..."); WaitMouseKey(40);
   PCTalk(); SuchinListenSad(); dText.Text=("I just need the cat before I go."); blab1();
   PCListen(); SuchinTalkSad(); dText.Text=("I..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I don't know where your cat is..."); blab2();
   PCTalk(); DBG1.Animate(16, 18, 3, eRepeat); SuchinListenSad(); dText.Text=("What?!"); blab2();
   PCListen(); DBG1.Animate(16, 19, 3, eRepeat); SuchinTalkSad(); dText.Text=("I... I don't know!"); blab2();
   PCListen(); DBG1.Animate(16, 19, 3, eRepeat); SuchinTalkSad(); dText.Text=("It run away when George go inside!"); blab2();
   PCTalk(); DBG1.Animate(16, 18, 3, eRepeat); SuchinListenSad(); dText.Text=("Well, where did he run to?!"); blab2();
   PCListen(); DBG1.Animate(16, 19, 3, eRepeat); SuchinTalkSad(); dText.Text=("...I...?!"); blab2();
   DBG1.Animate(16, 20, 3, eRepeat); SuchinListenSad();dName.Text=("Suchin: "); dText.Text=("..."); blab1();
   SuchinListenSad(); DBG2.Animate(121, 4, 3, eRepeat); //Suchin.Animate(7, 3, eRepeat, eNoBlock);//Crying
   dName.Text=("Su Chin: "); dText.Text=("(crying)"); blab1(); WaitMouseKey(50);
   PCListen(); DBG1.Animate(16, 20, 3, eRepeat); DBG1.Animate(16, 19, 3, eRepeat); SuchinTalkSad(); dText.Text=("I look all over and not find him..."); blab2();
   PCListen(); DBG1.Animate(16, 20, 3, eRepeat); DBG1.Animate(16, 19, 3, eRepeat); SuchinTalkSad(); dText.Text=("I don't know where he go, Andrus."); blab2();
   PCListen(); DBG1.Animate(16, 20, 3, eRepeat); SuchinListenSad(); dName.Text=("Andrus: "); dText.Text=("..."); WaitMouseKey(40);
   PCListen(); customerlisten(); dText.Text=(" "); dName.Text=(" "); StopPop();}   
   if (kickedouttalk!=1){
   int solly=Random(3);
   if (solly==0){
   PCTalk(); SuchinListenSad(); dText.Text=("..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I sorry, Andrus."); blab2();
   PCTalk(); SuchinListenSad(); dText.Text=("..."); blab2();}
      if (solly==1){
   PCTalk(); SuchinListenSad(); dText.Text=("..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("..."); blab2();}
      if (solly==2){
   PCListen(); SuchinTalkSad(); dText.Text=("Don't worry..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I still come buy newspaper."); blab2();
   PCTalk(); SuchinListenSad(); dText.Text=("..."); blab2();}
      if (solly==3){
   PCListen(); SuchinTalkSad(); dText.Text=("You..."); blab2();
   PCListen(); SuchinTalkSad(); dText.Text=("I so sorry George kick you out."); blab2();
   PCTalk(); SuchinListenSad(); dText.Text=("..."); blab2();}
PCListen(); customerlisten(); dName.Text=(" "); dText.Text=(" ");StopPop();}}
if (kickedout!=1){
if ((broomtalked==1)||(broomtalk>5)){
  int scr=Random(3); 
  if (scr==0){PCListen(); SuchinTalkSmile(); dText.Text=("We talk more later?"); blab1();
  PCTalk(); SuchinListenSmile(); dText.Text=("Yes. Good."); blab1();
  PCListen(); SuchinTalkSmile(); dText.Text=("I see you again soon then."); blab1();}
  if (scr==1){PCListen(); SuchinTalkSmile(); dText.Text=("There so much dirt out here..."); blab1();
  PCListen(); SuchinTalkSmile(); dText.Text=("I never get it all clean."); blab1();}
  if (scr==2){PCListen(); SuchinTalkSmile(); dText.Text=("It a warm day, huh?"); blab1();
  PCListen(); SuchinTalkSmile(); dText.Text=("I rather sweep today than on rainy day, you know?"); blab1();}
  if (scr==3){PCListen(); SuchinTalkSmile(); dText.Text=("Sweep, sweep."); blab1();
  PCListen(); SuchinTalkSmile(); dText.Text=("He he."); blab1();}
  
  PCListen(); SuchinListenSmile(); dName.Text=(" "); dText.Text=(" "); StopPop(); 
  Suchin.Walk(200, (Suchin.y), eNoBlock, eAnywhere); SetTimer(1, 20);}//End Talked
  //New Talk
if (broomtalked==0){broomtalked=1; broomtalk+=1;
if (broomtalk==1){//Work, or worked?
SuchinLove+=1;
PCTalk(); SuchinListenSmile(); 
if ((hour>=1)&&(hour<5)&&(ampm==0)){dText.Text=("You are working late tonight!"); blab2();}
if ((hour>=5)&&(hour<12)&&(ampm==0)){dText.Text=("Good morning!"); blab2();}
if ((hour>=1)&&(hour<8)&&(ampm==1)){dText.Text=("Hello again!"); blab2();}
if ((hour>=8)&&(hour<12)&&(ampm==1)){dText.Text=("You are working late tonight!"); blab2();}
if (hour==12){dText.Text=("Hello again!"); blab2();}
   PCListen(); SuchinTalkSmile(); dText.Text=("Yes - Hello, Mr. a-3."); blab2();
   PCListen(); SuchinTalkSmile(); dText.Text=("Are you working at News Stand today?"); blab2();
   PCListen(); SuchinListenSmile(); dName.Text=(" "); dText.Text=(" "); dBroomtalk_0.Start();}
if (broomtalk==2){//Just the weather.
SuchinLove+=1;
PCTalk(); SuchinListenSmile(); 
if ((hour>=1)&&(hour<5)&&(ampm==0)){dText.Text=("You are working late tonight!"); blab2();}
if ((hour>=5)&&(hour<12)&&(ampm==0)){dText.Text=("Good morning!"); blab2();}
if ((hour>=1)&&(hour<8)&&(ampm==1)){dText.Text=("Hello again!"); blab2();}
if ((hour>=8)&&(hour<12)&&(ampm==1)){dText.Text=("You are working late tonight!"); blab2();}
if (hour==12){dText.Text=("Hello again!"); blab2();}
   PCListen(); SuchinTalkSmile(); dText.Text=("Yes - Hello, Mr. a-3."); blab2();
   PCListen(); SuchinTalkSmile(); dText.Text=("It nice weather for cleaning."); blab2();
   PCTalk(); SuchinListenSmile(); dText.Text=("Yes. The weather is being nice."); blab2();
   PCListen(); SuchinTalkSmile(); dText.Text=("I almost done - I finish up now."); blab2();
   PCTalk(); SuchinListenSmile(); dText.Text=("Yes. Good. OK."); blab2();
   PCListen(); SuchinListenSmile(); dName.Text=(" "); dText.Text=(" "); StopPop(); 
   Suchin.Walk(200, (Suchin.y), eNoBlock, eAnywhere); SetTimer(1, 20);}
if (broomtalk==3){//What's wrong?
SuchinLove+=1;
PCTalk(); SuchinListenSmile(); 
if ((hour>=1)&&(hour<5)&&(ampm==0)){dText.Text=("You are working late tonight!"); blab2();}
if ((hour>=5)&&(hour<12)&&(ampm==0)){dText.Text=("Good morning!"); blab2();}
if ((hour>=1)&&(hour<8)&&(ampm==1)){dText.Text=("Hello again!"); blab2();}
if ((hour>=8)&&(hour<12)&&(ampm==1)){dText.Text=("You are working late tonight!"); blab2();}
if (hour==12){dText.Text=("Hello again!"); blab2();}
   PCListen(); customertalk(); dText.Text=("Hello."); blab2();
   PCListen(); customerlisten(); dName.Text=("Su Chin: "); dText.Text=("..."); WaitMouseKey(30);
   PCTalk(); customerlisten(); dText.Text=("Is something being...?"); blab2();
   PCTalk(); customerlisten(); dText.Text=("You look as if... Sad."); blab2();
   PCListen(); customertalk(); dText.Text=("Am in sad mood, today."); blab2();
   PCTalk(); customerlisten(); dText.Text=("...Oh."); blab2();
   PCTalk(); customerlisten(); dText.Text=("What is being the cause of your mood?"); blab2();
   PCListen(); customertalk(); dText.Text=("Oh, it nothing."); blab2();
   PCListen(); SuchinTalkSmile(); dText.Text=("You sweet man for asking, though."); blab2();
   SuchinListenSmile(); DBG1.Animate(16, 12, 3, eRepeat); dName.Text=("Andrus: "); dText.Text=("(blush)"); WaitMouseKey(30);
   PCListen(); SuchinListenSmile(); dName.Text=(" "); dText.Text=(" "); StopPop(); 
   Suchin.Walk(200, (Suchin.y), eNoBlock, eAnywhere); SetTimer(1, 20);}


if (broomtalk>=4){///Dialog Reconstruction Effort Starts Here
   Suchinbuy();}
   
}}}//End Suchin Broomtalk

}//End Uptalk

}//End Repex

function room_AfterFadeIn(){
  
 if (player.PreviousRoom==29){
   if (isdreambad==false){dSaveprompt.Start();}
   if (isdreambad==true){bad_wakeup();}
 }
  
  if ((GetGlobalInt(101) == 4)&&(GetGlobalInt(11)!=1)){
    cattro.Transparency=0;
    player.LockView(7); player.Animate(0, 3, eRepeat, eNoBlock);
    player.Walk(150, 192, eBlock, eAnywhere);
    player.UnlockView();
    player.LockView(31); 
    cattro.Transparency=100;
    player.Animate(3, 3, eOnce, eBlock, eForwards);
    player.ChangeView(31);
    player.SetIdleView(31, 0);
    SetGlobalInt(11, 1);
  }
  if ((GetGlobalInt(101)<4)&&(glembox.View!=109)){cattro.Transparency=0;}
  }

function region10_Standing()
{
if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)){
  Wait(5); player.DoorHandle(); Wait(20); PlaySound(60); TopUp("Locked", "This door won't open. It's locked."); player.DoorHandle2();}
}

function CatIntro()
       {
       player.UnlockView();
       player.LockView(31); 
       player.Animate(2, 3, eRepeat, eNoBlock, eForwards);
       player.Walk(150, 192, eBlock, eAnywhere);
       player.UnlockView();                 
       player.LockView(31); 
       player.Animate(0, 3, eOnce, eBlock);
       player.UnlockView();
       cattro.Transparency=0;
       TalkPop(); SetTimer(3, 43);
       }

function room_FirstLoad(){
  broomtalk=0;
  if (GetGlobalInt(101)<7){CatIntro();}}



function region9_WalksOnto()//Catdown
{if ((GetGlobalInt(101)==4)&&(GetGlobalInt(106)==0)){
       player.LockView(31); 
       player.Animate(0, 3, eOnce, eBlock);
       pick.NormalGraphic=2105; gPick.Centre(); gPick.Visible=true; close_pick.Visible=false;
       pick.Animate(108, 0, 2, eOnce); Wait(100);
       glembox.Transparency=0;
       player.UnlockView();
       player.ChangeView(3);
       player.SetIdleView(3, 0);
       glembox.SetView(109, 0, 0);
       glembox.Animate(0, 4, eRepeat,eNoBlock, eForwards);
       SetGlobalInt(11, 0);
       SetGlobalInt(101, 5);
       gPick.Visible=false;
       TalkPop(); SetTimer(3, 43);       }
else{}
}

function region9_Standing(){if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)){//Feetcat Dialog
if (GetGlobalInt(106) == 1){}//OUTSIDE GOING IN
else if (GetGlobalInt(106)!=1){
if (gDialog.Visible==false){
if (cSlot2.InventoryQuantity[Catfood.ID]!=0){dAndrusCat_0.SetOptionState(2, eOptionOn);}
if (cSlot2.InventoryQuantity[Catfood.ID]==0){dAndrusCat_0.SetOptionState(2, eOptionOff);}
if (player.InventoryQuantity[Milk.ID]!=0){dAndrusCat_0.SetOptionState(3, eOptionOn);}
if (player.InventoryQuantity[Milk.ID]==0){dAndrusCat_0.SetOptionState(3, eOptionOff);}
if (GetGlobalInt(101)==5){TalkPop(); SetTimer(3, 43);}
else if ((GetGlobalInt(101)>5)&&(GetGlobalInt(101)!=8)&&(GetGlobalInt(101)!=9)){dAndrusCat_0.Start();}//Can Feed Option Available
else if ((GetGlobalInt(101)==8)||(GetGlobalInt(101)==8)){//Where'd he go...?!
  pick.NormalGraphic=2139; gPick.Centre(); gPick.Visible=true; close_pick.Visible=false; 
                               pick.Animate(108, 2, 4, eOnce); Wait(100); gPick.Visible=false;}
                             
}}}}

function region8_Standing(){
  if((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)&&(gToothbrushing.Visible==false)&&(gToothbrushing.Visible==false)){
  if (GetGlobalInt(101)==8){//Look under bed
  pick.NormalGraphic=6939; gPick.Centre(); gPick.Visible=true; close_pick.Visible=false; 
  pick.Animate(108, 5, 3, eOnce); Wait(80); gPick.Visible=false;}
  if ((GetGlobalInt(106)==0)&&(GetGlobalInt(101)!=8)&&(GetGlobalInt(101)!=4)){
  if (vitality.Width<60){player.UnlockView(); player.StopMoving(); dSleep.Start();}
else{}
//else{}
}}}

function room_Leave(){glemcomplained=0; broomtalked=0;
George.LockView(66); George.SetWalkSpeed(2, 2);
if (Suchin.Room==7){Suchin.UnlockView(); Suchin.ChangeRoom(1, 10, 10);}
if ((kickedout==1)&&(George.x==265)&&(George.Room==7)){George.ChangeRoom(28, 205, 149); George.Baseline=0;}
}

function region15_Standing(){
       if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)) //Up Arrow
       {if (GetGlobalInt(11)==0){
       player.UnlockView();
       player.LockView(7); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(398, 75, eBlock, eAnywhere);
     player.UnlockView();}
     else if (GetGlobalInt(11)==1){
       player.UnlockView();
       player.LockView(31); 
       player.Animate(1, 2, eRepeat, eNoBlock, eForwards);
       player.Walk(398, 75, eBlock, eAnywhere);
       player.Animate(1, 2, eRepeat, eNoBlock, eForwards);
       player.UnlockView();
       }}
}

function region14_Standing(){
       if ((IsKeyPressed(380)==1)||(IsKeyPressed(83)==1)){//Down Arrow
       if (GetGlobalInt(11)==0){
       player.UnlockView();
       player.LockView(8); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(470, 139, eBlock, eAnywhere);
       player.UnlockView();}
     
     else if (GetGlobalInt(11)==1){
       player.UnlockView();
       player.LockView(31); 
       player.Animate(2, 2, eRepeat, eNoBlock, eForwards);
       player.Walk(470, 139, eBlock, eAnywhere);
       player.UnlockView();
       }}
}

function region11_Standing(){
if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)){ //Up Arrow
if (GetGlobalInt(101)==8){//Look under bed
  pick.NormalGraphic=6939; gPick.Centre(); gPick.Visible=true; close_pick.Visible=false; 
  pick.Animate(108, 6, 3, eOnce); Wait(60); gPick.Visible=false;}
}}
